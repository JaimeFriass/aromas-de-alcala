---

---

<div
    id="cookie-banner"
    class="fixed bottom-6 left-6 z-[100] max-w-[300px] w-[calc(100%-3rem)] bg-stone-900/85 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl p-5 transform transition-all duration-700 translate-y-32 opacity-0 hidden flex-col gap-4"
>
    <!-- Content -->
    <div>
        <div class="flex items-center gap-2 mb-2">
            <span class="text-lg animate-pulse">ğŸª</span>
            <span class="font-bold text-white text-sm tracking-wide"
                >Privacidad</span
            >
        </div>
        <p class="text-stone-300 text-xs leading-relaxed font-light">
            Usamos cookies para mejorar tu experiencia y analizar el trÃ¡fico del
            sitio.
        </p>
    </div>

    <!-- Actions -->
    <div class="flex items-center justify-between gap-3 pt-1">
        <button
            id="reject-cookies"
            class="text-xs font-medium text-stone-500 hover:text-stone-300 transition-colors px-2 py-2"
        >
            No, gracias
        </button>
        <button
            id="accept-cookies"
            class="flex-1 bg-white text-stone-900 px-4 py-2.5 rounded-xl text-xs font-bold hover:bg-stone-100 transition-all shadow-lg hover:shadow-white/20 text-center"
        >
            Aceptar
        </button>
    </div>
</div>

<script is:inline>
    // Configuration
    const GA_ID = "G-8S2VFXSTTY";
    const KEY = "aromas_cookie_consent";

    const banner = document.getElementById("cookie-banner");
    const acceptBtn = document.getElementById("accept-cookies");
    const rejectBtn = document.getElementById("reject-cookies");

    // Helper: Load GA Script
    function loadGA() {
        console.log("Loading Google Analytics...");
        // 1. Load the script tag
        const script = document.createElement("script");
        script.async = true;
        script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_ID}`;
        document.head.appendChild(script);

        // 2. Configure gtag
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag("js", new Date());
        gtag("config", GA_ID);
    }

    // Logic
    const consent = localStorage.getItem(KEY);

    if (consent === "granted") {
        loadGA();
    } else if (consent === "denied") {
        // Do nothing
    } else {
        // Show banner if no choice made
        if (banner) {
            banner.classList.remove("hidden");
            banner.style.display = "flex";
            // Small delay for animation
            setTimeout(() => {
                banner.classList.remove("translate-y-32");
                banner.classList.remove("opacity-0");
            }, 500); // Wait a bit so it doesn't pop up INSTANTLY on load
        }
    }

    // Events
    acceptBtn?.addEventListener("click", () => {
        localStorage.setItem(KEY, "granted");
        loadGA();
        hideBanner();
    });

    rejectBtn?.addEventListener("click", () => {
        localStorage.setItem(KEY, "denied");
        hideBanner();
    });

    function hideBanner() {
        if (!banner) return;
        banner.classList.add("translate-y-32");
        banner.classList.add("opacity-0");
        setTimeout(() => {
            banner.classList.add("hidden");
        }, 700);
    }
</script>
