---
const pathname = Astro.url.pathname;
const currentLang = pathname.startsWith("/en") ? "en" : "es";

const translations = {
    es: {
        links: [
            { text: "Inicio", href: "/" },
            { text: "Recomendaciones", href: "/que-hacer-en-alcala" },
            { text: "Contacto", href: "/contacto" },
        ],
        switchText: "EN",
        switchHref: "/en" + (pathname === "/" ? "" : pathname),
        currentLabel: "ES",
    },
    en: {
        links: [
            { text: "Home", href: "/en/" },
            { text: "Recommendations", href: "/en/que-hacer-en-alcala" },
            { text: "Contact", href: "/en/contacto" },
        ],
        switchText: "ES",
        switchHref: pathname.replace("/en", "") || "/",
        currentLabel: "EN",
    },
};

const t = translations[currentLang];
---

<header class="fixed w-full z-50 transition-all duration-300" id="main-header">
    <div class="max-w-7xl mx-auto px-6 py-6 flex justify-between items-center">
        <a
            href={currentLang === "en" ? "/en/" : "/"}
            id="header-logo"
            class="text-3xl font-black tracking-tight text-white hover:text-accent transition-colors"
        >
            Aromas de Alcal√°
        </a>

        <nav class="hidden md:flex items-center space-x-10">
            {
                t.links.map((link) => (
                    <a
                        href={link.href}
                        class="nav-link text-white/90 hover:text-accent font-medium transition-colors text-sm uppercase tracking-wide"
                    >
                        {link.text}
                    </a>
                ))
            }
            <div
                class="flex items-center space-x-2 text-sm font-bold border-l border-white/20 pl-6 ml-2"
                id="lang-switcher"
            >
                <span class="text-accent cursor-default">{t.currentLabel}</span>
                <span class="text-white/40 header-divider">|</span>
                <a
                    href={t.switchHref}
                    class="nav-link text-white/90 hover:text-accent transition-colors"
                >
                    {t.switchText}
                </a>
            </div>
        </nav>

        <!-- Mobile Menu Button (Hamburger) -->
        <button
            class="md:hidden text-white focus:outline-none"
            id="mobile-menu-btn"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>
    </div>

    <!-- Mobile Menu -->
    <div
        class="md:hidden hidden bg-stone-900/95 backdrop-blur-md absolute w-full shadow-lg"
        id="mobile-menu"
    >
        <nav class="flex flex-col p-6 space-y-4">
            {
                t.links.map((link) => (
                    <a href={link.href} class="text-white text-lg font-medium">
                        {link.text}
                    </a>
                ))
            }
            <div
                class="flex items-center space-x-4 pt-4 border-t border-white/10 mt-2"
            >
                <span class="text-accent font-bold">{t.currentLabel}</span>
                <a
                    href={t.switchHref}
                    class="text-white font-medium hover:text-accent"
                >
                    {t.switchText}
                </a>
            </div>
        </nav>
    </div>
</header>

<script>
    const header = document.getElementById("main-header");
    const logo = document.getElementById("header-logo");
    const navLinks = document.querySelectorAll(".nav-link");
    const mobileBtn = document.getElementById("mobile-menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");

    if (header) {
        window.addEventListener("scroll", () => {
            const dividers = document.querySelectorAll(".header-divider");

            if (window.scrollY > 50) {
                header.classList.add(
                    "bg-white/95",
                    "backdrop-blur-md",
                    "shadow-sm",
                    "py-4",
                );
                header.classList.remove("py-6");

                logo?.classList.remove("text-white");
                logo?.classList.add("text-stone-900");

                navLinks.forEach((link) => {
                    link.classList.remove("text-white/90");
                    link.classList.add("text-stone-600");
                });

                dividers.forEach((d) => {
                    d.classList.remove("text-white/40");
                    d.classList.add("text-stone-300");
                });

                mobileBtn?.classList.remove("text-white");
                mobileBtn?.classList.add("text-stone-900");
            } else {
                header.classList.remove(
                    "bg-white/95",
                    "backdrop-blur-md",
                    "shadow-sm",
                    "py-4",
                );
                header.classList.add("py-6");

                logo?.classList.add("text-white");
                logo?.classList.remove("text-stone-900");

                navLinks.forEach((link) => {
                    link.classList.add("text-white/90");
                    link.classList.remove("text-stone-600");
                });

                dividers.forEach((d) => {
                    d.classList.add("text-white/40");
                    d.classList.remove("text-stone-300");
                });

                mobileBtn?.classList.add("text-white");
                mobileBtn?.classList.remove("text-stone-900");
            }
        });
    }

    if (mobileBtn && mobileMenu) {
        mobileBtn.addEventListener("click", () => {
            mobileMenu.classList.toggle("hidden");
        });
    }
</script>
